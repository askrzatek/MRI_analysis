%% VISUALISATION des resultats modeles 2 sample t-test Effet d'Alerte & RT_STD dans l'ANT

clc
clear
addpath /home/anna.skrzatek/MRI_analysis/AUDICOG/

main_dir = '/network/lustre/iss02/cenir/analyse/irm/studies/AUDICOG/DATA/Non_chirurgicaux';
project_dir = '/network/lustre/iss02/cenir/analyse/irm/studies/AUDICOG';

cd(project_dir)

load('e_nonchir.mat');

d = readtable( [ './DATA/' , 'Correspondance_Numero_Comportement_IRM.csv' ])  ;
tab = readtable(fullfile(project_dir,'DATA/AUDICOG_behavioral_data_Groups1_2.csv'));
% tab = readtable(fullfile(project_dir,'DATA/All_data_08_04_2024_IRM_corresp.csv'));

groups.name = {'Control' 'Tinnitus'};
sex.indexes = cell(25,2);
m = 0;
f = 0;

% covars.name = {'Age','Genre','pca_audio1','pca_emotionnel1','log_ANT_RT_Alerting'};
% covars.name = {'Age','Genre','pca_audio1','pca_emotionnel1','STD_RT_ANT'};
covars.name = {'Age','Genre','pca_audio1','pca_emotionnel1','log_ANT_RT_Alerting','STD_RT_ANT'};
% covars.name = {'Age','Genre','pca_audio1','pca_emotionnel1','log_ANT_RT_Alerting','STD_RT_ANT','Pertes_auditives','Autre_type_pertes','THI','Autres_types_patho_audi'};

% getting scans & covariates organised per group
scans = cell(1,length(groups.name));

for igroup = 1:length(groups.name)
    j = 0 ;
    for iSubj = 1:length(e)
        
        ifile = e(iSubj).name;
        id = str2double(ifile(25:end)) ;
        subj_group = d.Groupe( find (d.Num_IRM == id) )  ;
        
        if str2double(tab.Genre(tab.code_IRM == id))==1
            m = m+1;
            sex.indexes{m,1} = iSubj;
        elseif str2double(tab.Genre(tab.code_IRM == id))==2
            f = f+1;
            sex.indexes{f,2} = iSubj;
        end
        
        if subj_group == igroup
            j = j + 1 ;
            for icov = 1:length(covars.name)
                scans{igroup}.cov{j,1} = tab.Age(tab.code_IRM == id);
                scans{igroup}.cov{j,2} = str2double(tab.Genre(tab.code_IRM == id));
                scans{igroup}.cov{j,3} = tab.pca_audio1(tab.code_IRM == id);
                scans{igroup}.cov{j,4} = tab.pca_emotion1(tab.code_IRM == id);
                scans{igroup}.cov{j,5} = tab.ANT_Alert_Score(tab.code_IRM == id);
                scans{igroup}.cov{j,6} = tab.RT_STD(tab.code_IRM == id);
%                 scans{igroup}.cov{j,5} = tab.ANT_STD_mean(tab.code_IRM == id);  
%                 scans{igroup}.cov{j,7} = tab.Perte_auditive(tab.code_IRM == id);
%                 scans{igroup}.cov{j,8} = tab.Autre_type_de_perte_auditive(tab.code_IRM == id);
%                 scans{igroup}.cov{j,9} = tab.THI(tab.code_IRM == id);
%                 scans{igroup}.cov{j,10} = tab.Autres_pathologies_auditives(tab.code_IRM == id);
%                 scans{igroup}.cov{j,11} = tab.Duree_acouphene(tab.code_IRM == id);
            end
        end
    end
end

covars.val = {vertcat(scans{1}.cov{:,1},scans{2}.cov{:,1});vertcat(scans{1}.cov{:,2},scans{2}.cov{:,2});vertcat(scans{1}.cov{:,3},scans{2}.cov{:,3});vertcat(scans{1}.cov{:,4},scans{2}.cov{:,4});vertcat(scans{1}.cov{:,5},scans{2}.cov{:,5});vertcat(scans{1}.cov{:,6},scans{2}.cov{:,6})};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Double Variable Of Interest Model + PCAs
%
% WRITE PLOTS FOR RESULTS FWE-corrected
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Group differences
% Control > Tinnitus
%% dPC - Temporal Inf (BA37)
y = [0.0893703139940133
0.144051987679498
0.0179172188204604
0.0112647704216995
0.103633739005525
0.156074498400306
0.121747521927742
0.168637637009592
0.263757307325304
0.166129357819153
-0.0332184520791373
0.0551226433419581
0.00133289873607902
0.0662764976338296
0.102723490945904
0.114300226947346
0.0587178999339148
0.174994692166100
0.0948877567593492
0.0741876623403626
0.0489206266418199
0.00890298148075268
0.0980417997029479
0.0594646949695752
0.208916619698903
-0.0991089524933485
0.0241952330961689
-0.134029919550232
-0.0746020537982398
-0.0520987067640626
-0.131530963432245
0.00141057632351911
-0.0942882015049898
-0.191269569673406
-0.114620946591319
-0.150841506184965
-0.0881323301644904
-0.0849433965931494
-0.0687906154222375
-0.106771125542172
-0.0582416424184041
-0.00470957861640938
-0.121798925287736
-0.192942287743957
-0.104556871964651
-0.0622109612390723
-0.0746823110490442
-0.161642656203961
-0.141976753771628
-0.107669026223888];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between dPC & BA37 across groups')

%% dPC x BA19 (OCcipital Mid & Sup)
y = [0.229964593280473
-0.0288035730696279
-0.0307717329369695
-0.0617234706729494
0.178897098567451
0.104414690331664
-0.112691308524706
-0.00608043658200566
0.340404334859576
0.0710434354298553
0.0591417482823936
0.114241302345430
-0.322031333608275
0.228435083645446
0.232350204698010
0.0313713111894707
0.171921014237254
0.146966045309403
-0.0534654016351011
0.288029701660925
-0.0434530621704096
0.0519205302798403
0.0751143248633245
0.111505713400247
0.246800494535587
-0.133208490270452
0.173462574473436
0.0729099338949387
-0.234779345329668
0.0688724301673539
-0.152704878005218
0.181254997961264
-0.0827197611730160
-0.144311983469818
-0.0710272064389301
-0.0989867692912034
-0.0361996716701771
-0.243219362833970
-0.0531236795659763
0.0910322496561931
-0.283610561599218
-0.120589881681425
0.0424153760248099
-0.346939096482372
-0.0663732248997232
-0.250669525097421
-0.200591835334611
-0.102846640792249
0.189913052185214
-0.238233782024678];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between dPC & BA19 across groups')

%% OFC L x ACC R
y = [0.0114380234102448
0.140524120409830
0.239218305268026
-0.241021347193716
0.165523733036868
-0.00975883561495716
0.380993996117491
-0.180750511191799
0.330832784719325
0.291823824981030
0.0238827710544299
-0.0196455153620295
-0.0282387142334273
-0.0700015123319006
0.0312103937022669
0.0212033841843454
0.00771670623248660
0.0538155940382673
0.178640203084975
0.275280454000272
0.126770354888394
-0.0102783037990582
0.154243687596750
0.192693962610922
0.0907062818011565
-0.0606177126313997
0.0882145181354644
-0.0256567427724626
0.0829989919399710
-0.0180046240556670
-0.122185351194304
0.0286489190698936
-0.0588547233114944
-0.269962352933412
-0.167649854461704
-0.254987015982692
-0.0278102576948669
-0.0307320597564670
-0.0712371587855000
-0.104004154110665
0.0202251809972316
-0.0628155577435514
-0.300384245915417
-0.208881645320208
-0.0763936329226554
-0.133493166023974
-0.0735591913893414
-0.0367621477862821
-0.0850900778156182
-0.172996501624669];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between OFC & ACC R across groups')

%% Audio L x BA9 R (Frontal Inf Tri)
y = [0.0342960023906667
0.0542810250107785
0.0576367570535558
-0.00120289991297119
0.151388777196332
0.0936752354193213
0.231734969981271
0.188354793648016
0.125934804096283
0.0269441654660592
0.124505886061169
-0.00776246595216645
-0.0680955548946561
0.0552234595146581
0.0338251666567349
-0.0691372116783266
0.0144174089143550
0.127506047038571
-0.0793551978688459
-0.0581945955298900
-0.0382722277966826
0.0748184276245217
0.152518178184115
0.115454088587899
0.00119666447447224
-0.0936519004534984
0.00168274657582587
0.0123692388577668
0.00502990820431409
-0.0190532455016285
0.0282192002919273
-0.000287284237123528
-0.193453771712912
-0.304284197807409
0.00155514271432922
-0.0695088762368871
0.165268668113100
-0.125303033551161
-0.0183469011825781
-0.0407730824685728
-0.0870264637713913
0.0439387670324365
0.0194376788793771
-0.229740643373412
0.0692641455801353
-0.0129583868057001
-0.0695851581108091
-0.203505907574533
-0.0432090418783559
-0.201013539432115];


figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between AC L x BA9 R (Frontal Inf Tri) across groups')

%% Audio L x BA 6 R (clFWE = 0.085)
y = [];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between AC L & BA6 (Frontal Sup & Mid) across groups')

%% Audio R x BA6 R
y = [-0.0474525810612252
0.0320434661382829
0.0308584483280230
-0.0705285778049714
-0.0445327236572557
0.266174708960188
0.111128834706594
0.00606155603915998
0.243712212357283
0.0208546908211762
0.0798943519535541
-0.0589190120307857
0.0563815564808203
-0.0711298501401082
0.0836695408904338
0.198187785200724
-0.109444115710074
0.0638365754083224
0.242497576104614
0.159800475589171
0.0651080225205236
0.174743875989227
0.00169750432935159
-0.0202894077596443
0.295235501277442
-0.155342024664790
-0.275353708601173
0.0623523570712837
0.212273230304719
0.0732991432200425
0.0124131322735730
0.0501097272323152
-0.137563967290860
-0.162071762411647
-0.169463046782814
-0.125713043781490
-0.0641712347058714
-0.222915297478677
0.203652473032858
-0.0800313849873951
-0.0680269227533113
-0.0232964236138989
-0.144121386767160
-0.361978819742848
-0.187815001620932
0.00834173469226370
0.0660850949785056
-0.0476800191804148
-0.199638734812298
-0.0923655439064343];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between AC R & BA6 R (Frontal Sup & Mid) across groups')

%% Audio R x BA38 R
% Control < Tinnitus
y = [0.0808274828255828
-0.0765804220901822
-0.00759589622089507
-0.0312889033849376
-0.141314914056392
-0.134377033162638
-0.0411176572364121
-0.226465068774228
-0.112063002770981
0.114103401026749
-0.0244894796450042
-0.0739004245531815
-0.0918960486670269
-0.105311088350928
-0.156960889854122
-0.00995953368889091
0.0212746510143109
-0.0947303972746662
0.0196100062828638
-0.0368231754961279
-0.0474093529530224
-0.0220115130398308
-0.0840725954894743
-0.0434694464303848
-0.181180974426481
0.107535473597106
-0.00107114964430743
-0.0523463647899202
-0.0931099609279502
0.0148027735572001
0.112210391499578
-0.108106068173843
0.0591985479497592
0.201633400086279
0.270552445230987
0.232760515313156
0.0768779160293416
-0.0664489013426946
0.120698581565499
0.0248577129888714
0.0598276562265489
-0.0972000366268306
0.0403254040512215
0.0305011007942792
-0.0151986637932940
-0.0610061322391149
0.173865127127293
0.166153339121571
0.175700176690996
0.239481287086963];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between AC R & BA38 R (Temporal Pole Mid) across groups')

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Alerting Effects
x = covars.val{5}; % ANT Alerting RT log

%% Cingulate x Crus II L

y = [0.0315670033084194
-0.0681283830651507
0.0967728646827308
-0.262564548334164
-0.00246023742227029
0.0324183391345713
-0.0870506619115236
0.210789103879869
0.0542658961890259
-0.0823801870556117
-0.250650884424758
-0.364944925193081
-0.154530600334194
0.233751607043835
-0.0866590501816847
0.0795668482322995
-0.165836665608807
0.366075527666739
-0.0362312794452268
0.127139158021814
-0.236022300183183
0.272362344273833
-0.125274569080678
-0.0237563172350384
0.441781917042235
0.324946020234087
-0.0427782244790787
-0.00746464786541830
-0.154808433985615
-0.140741854882719
-0.113495974487033
-0.150347651066956
0.0821216607857697
0.0404513457480794
-0.0826967100092558
0.0246112088662802
-0.0889168800656783
0.0428666520063949
0.152796583569484
0.0955622415946084
-0.0376935834834127
-0.251942778580843
0.0466035830712263
-0.0862607855258762
-0.108434763542796
0.0757015018508094
-0.0230150960359781
0.0626061125990617
0.0657989745699909
0.274531499114877];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([-0.1 0.1])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title('Alert x FC dPC x Crus II L) across groups')
title(sprintf('Alert x FC (Cingulate/BA 31 x Crus II L) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% RT Standard Deviation Effects
x = covars.val{6}; % ANT Alerting RT log

%% Parahippocampus x BA25 L (Caudate Head)

y = [-0.150506396724123
-0.0677323753208008
0.0209722825134332
0.000911983798793176
-0.0673918158626891
-0.125992436673119
0.246061443001573
0.130028732287242
0.133956963194882
0.115973297252275
-0.0266899974756697
-0.103410012704410
0.117720093182036
-0.219757389890614
0.164961623868248
-0.152343982849037
-0.0857106766656379
0.183900331983429
0.111398476250118
-0.121958593189725
-0.118706559655814
-0.102158620036437
0.0398888221589399
-0.0861264591754416
0.162711266732548
0.0233900948595357
0.110885507780418
-0.0875080189882994
-0.0776479431454453
0.112039410103558
-0.0901554534775625
0.114675259066925
-0.0672671620605207
0.141368465488088
-0.0352561278974518
0.107613428919704
0.00126476133354408
0.0666394691090285
-0.0392117301420069
-0.0714306691562501
0.0291948041796568
-0.0629739695986405
0.194503502457420
-0.160122902645613
0.0559539361475038
0.0325847232142796
-0.0670574139183345
-0.133059188487628
-0.0469819974072927
-0.0514407857346216];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([0 0.4])
ylim([-0.35 0.35])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('RT STD x FC (Parahippocampus x BA25 L (Caudate)) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%% Parahippocampus x BA40 R (Parietal Inf) TREND

y = [-0.0159408775400055
-0.0332789086563297
-0.142890247445557
-0.122800628342689
0.0751490952109034
-0.127504112962231
-0.215620720174060
0.234493616762902
0.0470205200795985
0.00213985638847975
-0.149870909292702
0.146348062125121
0.303075355374444
-0.129445219785708
-0.00313686181348974
0.00658658098129326
0.0373950053180578
0.282283152487118
0.0616456896418382
-0.136360297496578
0.0146081393937143
-0.0224887702728753
-0.0373509202525325
-0.159363599593828
0.0853069998651135
-0.0716710124177891
0.245743488944719
-0.261245181460929
0.0533333821630628
0.398628874470892
-0.0507778380879550
0.0449723216624470
-0.0234929684267464
-0.172310002090102
-0.105917982083220
0.140450428097451
-0.0297538507441364
-0.0939365087116479
0.0876442827275913
-0.0390379271842350
-0.283191650605505
-0.000435788107981054
-0.0270570744781163
0.0635750029495244
0.0670188097846825
0.334816139832847
0.0797187481539646
-0.163145416317334
-0.196171283286522
0.00224300521503508];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([0 0.4])
ylim([-0.45 0.45])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('RT STD x FC (Parahippocampus x BA40 R (Parietal Inf)) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% RT Standard Deviation x Group Interaction
x = covars.val{6}; % ANT RT standard deviation

%% dPC x BA39 R (Temporal Mid)

y = [-0.226579674135328
0.0169384215318450
-0.379249826706877
0.145884080139795
0.156051556330974
-0.240934414678075
0.301142747363580
0.464693244813017
-0.0300222671534622
0.124815299180930
-0.0178416329989658
-0.0203114291983826
-0.197595668034197
-0.172372601855925
0.265603436352049
-0.279901301134656
0.212375446401639
0.509282039645493
-0.275184716346174
-0.0278279030179053
-0.346128539939384
-0.113356020431195
0.104540714612678
-0.240798609744620
0.266777619003149
0.128565307172818
0.171394943886608
-0.200107313932220
-0.0984257716628671
-0.341214222347562
-0.0182585404751685
0.0186606461573778
0.117837717228861
0.155197240417047
0.132700015107218
-0.0202955537664184
-0.0202270873763385
0.151255588382131
-0.425158619647600
0.209500898641167
0.186341199255980
-0.147715664433173
0.171029579496271
0.293872086046115
0.301461840166829
-0.467858537579849
-0.237138815782115
0.0178942754008026
-0.141001423327275
0.0616902129713761];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([0 0.4])
ylim([-0.55 0.55])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('RT STD x Group x FC (dPC x BA39 R) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% PCA Audio Effects
x = covars.val{3};

%% Parahippocampus x BA18 R (Occipital Sup) : cluster on the brain mask limit

y = [-0.107541346740233
0.177661617399414
-0.271300455763744
-0.299168994023967
0.177417887508895
0.203129705694931
-0.0307732577863572
0.0451403048750814
0.218779633650698
0.0105675092300311
0.0328219607277507
-0.112910820709909
-0.160966870027107
-0.113866448059363
-0.252841266376085
-0.157673383329021
0.249027502512853
0.111207127558584
-0.240447103280433
0.0678170405660057
0.276987322081806
0.111828640810542
0.0526955958151220
-0.000237101543542340
0.0126451992082363
0.189029795322233
-0.0319653139505324
0.0921559342364480
0.0137536872819430
-0.189134870685673
0.135715292879212
-0.00268891363964505
-0.0572855536867817
0.00242913447970264
-0.183001886412103
-0.148097441590213
0.00541726296480032
-0.0326603344110592
0.00669893260069725
-0.264870623304066
0.00532626062488313
0.168663131604538
-0.181491370866271
0.0751720137633355
0.119850798002483
0.106546162368564
-0.116682055449876
0.0905229875643064
-0.00180942926092417
0.198406399564116];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([0 120])
ylim([-0.5 0.5])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('PCA Audio x FC (Parahippocampus x BA18 R) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%% Parahippocampus x BA39 L (Temporal Mid)

y = [0.0792627389009593
-0.0121990916224238
0.0745286816210914
0.235390041658308
-0.0454019233139760
-0.318342276728821
-0.0146699688240100
0.291719778510532
-0.231382657472187
0.0396406064065244
-0.0938328633206037
0.198237634467874
0.189360093965658
-0.0183738010046577
0.0436094081460811
-0.0693981203317591
-0.178872373459096
0.165965836115756
0.102512117380757
-0.109516501461991
-0.224687165244196
-0.0907068244298017
-0.0177343255917233
0.235448622138941
-0.230557666507433
-0.0782395357522989
-0.195204549675240
0.228813818262291
-0.233002555115333
0.146244797327075
-0.284170623246342
0.0717360645957689
0.0890127781397990
0.00546727445792590
0.0306380532338119
0.106553738955989
0.107417536585033
-0.123057424764715
0.0463665443326870
0.281159668675174
0.0910908830998542
-0.189359668287175
0.221815130466541
-0.121357980672696
-0.249837967547813
-0.102168980131622
-0.00772986503183530
0.0355213384881946
-0.115287088436468
0.237578612041275];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([0 120])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('PCA Audio x FC (Parahippocampus x Temp Mid R) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%% Parahippocampus x Occipital Mid R)

y = [0.168342148345416
-0.0955392535022649
-0.0108427540282660
0.426636132241548
0.349628542956334
-0.366003749172831
0.155583040492081
0.0408661674252703
-0.0713619970675230
0.0385496539285614
0.0852872544979327
-0.118842057386349
-0.0678408222118334
0.0571889663160193
0.0696859021891677
-0.0299913398760861
-0.196547836338760
-0.169489576621093
0.00675578849128568
0.110305298417201
-0.0865280681226287
-0.253747171180233
0.0954165412948517
0.116408700872223
-0.253919511960223
-0.192055966317086
0.212774322763961
-0.129686923181854
-0.0491385537823301
-0.0529315707048009
-0.311223538435440
-0.108707438436186
0.0262273993131130
0.148075448321582
0.201155209280767
0.109977106430631
-0.145790588325321
-0.0866390046910380
-0.165242274844740
0.136390867915892
0.0832129907550023
0.113162866694487
0.124499821022574
0.270259803069321
-0.114280689822630
-0.136594142062311
0.0797894855639781
0.126148965203279
-0.139871174056389
0.000487578325417208];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([0 120])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('PCA Audio x FC (Parahippocampus x Occipital Mid R) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% PCA Emo Effects
x = covars.val{4};

%% Audio L x Frontal Mid R 

y = [-0.0456209934838416
0.0932674307899897
-0.123112664774466
-0.00770730458680386
-0.118914015473880
0.314063118622100
-0.000326480865704693
0.0548125928824095
0.0366000721479279
0.0508542138447614
-0.121138002499968
0.00492393054941990
-0.0252987540606170
-0.0997020608638902
-0.0175477177678507
0.0745453126526778
-0.0768575484572578
-0.0626136050611819
0.141130086355720
0.0562378163344228
0.100728444481551
-0.127043722574485
-0.00358056757184567
-0.00123960951632775
-0.0964599711028591
0.0904878988235367
0.0253539503148439
-0.0425859434809659
0.321667330208615
0.249790825917388
-0.154273292156482
0.0130201209750559
0.170386450118661
-0.203401435555287
-0.0840468805273061
-0.0300163016648602
0.0664814356500111
0.268934232783884
-0.178709316164657
0.0980059321316071
0.0604290466992169
0.0143531268808154
-0.000495182752267190
-0.327926906652169
-0.0789362944372821
-0.165788156258499
-0.00833394606780667
0.0180609184536385
-0.117206311840256
-0.00525130139944274];


[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([0 120])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('PCA Emo x FC (AC L x Frontal Mid R) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Sex Effects
x = covars.val{2};

%% Audio R x Supramarginal Gyrus & Postcentral Cortex R 

y = [0.0687991318533317
-0.197243739052439
0.217627813393360
-0.318307159425136
0.0103473065381757
0.166190732509036
-0.0862395572878984
0.0385309450144456
0.0748091013932804
-0.0922593672389891
0.0411087563978505
0.0332800872522819
0.183331629333369
-0.240664073015320
0.144198814570146
0.0792052070643483
0.0297714830465499
-0.0152755509896157
-0.107925699126157
-0.000298594923005102
-0.0589159438108550
0.0726496642530913
-0.0722454621515724
0.119293712661530
-0.0897692382598104
0.201649549952075
0.0203549777633939
0.173319754452312
0.0889090357270716
0.224243748715230
-0.163268791377063
0.00529182660934507
-0.0161395382479140
-0.0888120166979203
-0.543585424142263
0.208669490502619
-0.0645590207369697
0.194886555657046
0.100918499559404
0.0785811988735275
0.141139853086211
-0.291083196023674
-0.0380993411394825
0.174561741103489
0.0385388209660037
-0.362764567311079
0.0371514380973796
0.0466940125663621
-0.124933545869159
-0.0416650620859557];

figure
boxplot([y(vertcat(sex.indexes{1:25,1})),y(vertcat(sex.indexes{1:25,2}))], 'Notch','on', 'Labels', {'F', 'M'}, 'Whisker',1);
title('Sex x FC (AC R x Supramarginal Gyrus R & Postcentral Cx)')


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Double Variable Of Interest Model (no PCAs)
%
% WRITE PLOTS FOR RESULTS FWE-corrected
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Group differences
% Control > Tinnitus
%% dPC - Temporal Inf (BA37)
y = [0.274667944990983
0.169519527260014
-0.110702836058179
0.206564194190771
0.127111560838680
0.338154428701283
-0.0213657936493319
0.332965321287601
0.196096214567179
0.102777784059261
-0.126959129883493
0.0175018300560638
0.0815114494886656
0.0390775187814088
0.268020073917964
-0.148848544186431
0.107295619176933
0.315024732919816
0.0864643943508806
0.0362460080609225
-0.0348584121035075
-0.210271739034030
0.0174587802153301
0.139091228603963
0.196712846563348
-0.321035307812575
0.161356075047556
0.00725811813740415
-0.303479826404244
-0.0116830502326877
-0.102879445161279
-0.0793145553078623
-0.136907066564505
-0.236261728695484
-0.161568612244560
-0.265114797596761
-0.245415863061526
0.0178425108509349
-0.153628435673273
0.0308368670989668
-0.0479477509146646
-0.135571056340210
-0.0625005710153089
-0.0547148218477572
-0.00990046877381365
-0.167857437990370
-0.0516858839489183
-0.0732324938976365
-0.132540153118512
0.133122665762867];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between dPC & BA37 (Temporal Inf) across groups')

%% OFC x BA24 R
y = [0.0195664783401528
0.0631932324411047
0.236230165187694
-0.193638257269709
0.0792915984449465
-0.111033955882157
0.421062404342388
-0.132203320523217
0.346070614047454
0.171561303614167
0.0829200215675181
-0.0809444922991501
-0.169924755819554
0.0103427258449445
-0.000211319020613387
0.155505457193357
0.222609721362986
0.0995277450039298
0.255089917228605
0.255046571645190
0.120604803157213
0.0671621966774860
0.184937753569150
-0.00493943235946660
0.0294529051507119
-0.204816348640288
0.0525686277775091
-0.0477927952627142
-0.0101181383722123
-0.129445168436955
-0.0984133635766607
-0.153884537880564
0.0942407172662991
-0.157171108704587
-0.276347035375520
-0.184518681995242
-0.0923127031906116
0.115893707562323
-0.0712899832609384
-0.180740969433931
0.0172467086673114
-0.0440460050369082
-0.184500068390668
-0.181229129685094
-0.0924346925232077
-0.0331819681828193
-0.179431215382273
0.0437045217989100
-0.0435252547436097
-0.0685709932690103];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between OFC & BA24 (Cingulate) across groups')

%% lAC x Temporal Pole Mid R
y = [-0.0561685531471515
-0.0268038685120136
0.0735889631327974
0.0266725913873276
-0.104055916401430
-0.0469280344218759
-0.0577904871729748
-0.0506069351958005
-0.143698214059246
0.0330391478074063
-0.160498557930907
-0.0356602332896848
-0.0348870140628744
-0.141720554741736
-0.0872970629570011
-0.146928845189788
-0.00595918883248646
-0.327674293773419
-0.0859759796268732
-0.203901773648974
0.0303288324548760
0.0455797318126040
-0.0926161443448269
-0.0254368785757449
-0.138273210251176
-0.0584237481083756
-0.0199161526321712
-0.0875031531786827
0.0596154686537341
0.191948565579683
0.109246386074940
-0.123551314217542
-0.0366143040345753
0.213005113834499
-0.0644136056178661
0.139611541934691
0.234162085072851
0.0268439447460775
0.0725102037632172
0.0986272037416900
0.0514775487606926
0.0539187699251163
0.143410192921048
0.132591853891588
-0.0291629365344035
-0.0454465660432169
0.272193642354539
0.140214659096701
0.0300331558311400
0.302272533275667];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between Audio L & Temporal Pole Mid R across groups')

%% lAC x BA21 R (Temporal Mid) - TREND
% Control < Tinnitus
y = [0.0357245378724507
-0.168095055335988
-0.0850984256303305
-0.0138080444042447
-0.0498247648855856
0.0164141589441182
-0.0328487096579780
-0.186246071623312
-0.134007746427824
0.0233655299901992
-0.0136500052743061
0.0129472490032589
-0.116861905564883
0.0785700068949982
-0.164689822520135
-0.270897229630187
-0.0239822717188257
-0.0865761992329097
-0.0333286407677657
-0.125991641619750
-0.0561302143663885
-0.0164049222185688
-0.0636323735642929
-0.0388617846497829
0.00569568598809173
-0.00171801929181387
0.0410410620731157
-0.00938547588940185
-0.0343242627919137
0.0576159089193135
0.0517520795797734
-0.0456122099147052
0.136633652344571
0.0776059091616339
0.381646276625474
-0.0628616094124781
-0.00210840569939659
0.0374752106611859
0.0639862586388473
0.214572253725341
0.205038944215466
-0.165883084453330
0.0382119870989289
0.175936335639182
0.00387826149942881
0.0175585310299970
0.278765083949610
0.136217215232652
0.00496588102267420
-0.0560356210441072];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between Audio L & BA21 R (Temporal Mid) across groups - TREND')

%% rAC x BA38 R (Temporal Pole Mid)
y = [0.129203162411168
-0.348480456486511
-0.117585193039579
0.0125199868163276
0.113143817918157
-0.321428687437826
-0.151894572711549
-0.269348536685481
0.000408058533585970
-0.126415301958580
0.0980230475971957
0.0292552499812832
-0.193309377072192
0.0402890443725371
-0.228565275127739
-0.0628371287079930
-0.149153567517806
-0.150448738254226
-0.0968263543842357
-0.0452543963043341
0.0726322419979590
0.0286703924095313
-0.0645076845601568
0.0118273038685910
-0.129114138912883
0.170978645504502
0.0516093255978763
-0.00894029307372626
0.194084555041239
0.199836750291048
0.0747198714351647
0.0172547063524007
0.125121164197521
0.147031333453082
0.0289030557665275
0.147607505839935
-0.0898683758322830
0.147519496186650
0.0840831252260460
0.107748258151461
0.0705971661375410
-0.146810500933568
-0.00874214289527842
0.198680189774934
0.0761812886340383
-0.0755628015962913
0.114546368366928
-0.0275151921723869
0.155491836446263
0.292960054450047];

figure
boxplot([y(1:25),y(26:50)], 'Notch','on', 'Labels', {'Control', 'Tinnitus'}, 'Whisker',1);
title('FC between Audio R & BA38 R (Temporal Pole Mid) across groups')


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Alerting Effects
x = covars.val{5}; % ANT Alerting RT log

%% Cingulate x Crus II L

y = [0.0694410576910031
-0.0655113897240016
0.134953512630823
-0.219849616875193
0.0209901781791740
0.0178874990571060
-0.0620179688994348
0.223012593602812
-0.0181089376281743
-0.0758731597082258
-0.250410929312144
-0.350067526598671
-0.134845183643472
0.237430833031760
-0.0335540930016185
0.0920720467011490
-0.271964379472780
0.378336246484200
-0.0671054593516929
0.159226328297770
-0.258494113035343
0.244500197691474
-0.159845849078623
-0.00974600255890162
0.399544115521008
0.283192900659456
-0.0612949470879526
0.0159666634061776
-0.134778948534453
-0.121805920776182
-0.176377218351596
-0.198246922788075
0.0831287271561091
0.0414473120487663
-0.0528095004542718
0.0584876493782058
-0.110581594249387
0.0311037907143210
0.168688587287719
0.155200265394263
-0.0254472782239715
-0.279368775989827
0.0494849676929869
-0.0736474683306975
-0.113163480391506
0.0451479424697295
-0.0201854993393103
0.0961085525712965
0.0607748852314497
0.278975310506732];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([-0.2 0.2])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title('Alert x FC dPC x Crus II L) across groups')
title(sprintf('Alert x FC (dPC x Crus II L) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%% Parahippocampus x Precuneus L
y = [0.155200931026500
-0.228825746911174
0.0624698668212008
-0.122706270977731
0.109765336063341
-0.0367265998892110
0.0643228271886755
0.319040606579626
0.0845223961447848
0.0463665482252834
-0.334959546302863
-0.314711724581962
-0.176203660226686
0.310727303173124
-0.0756462124975190
0.184395588626647
-0.155448435274924
0.0247482969633291
0.0101265811310104
0.0246131974928001
-0.0562266311022519
-0.111477288948376
-0.0378744865230163
0.0939568126267511
0.160550311172638
0.0712471411006170
0.0891502532521959
-0.155427572097416
-0.159426679775742
-0.0371510781341546
-0.172766294563272
-0.115225905495372
-0.0338052506213385
0.194469638227384
-0.0351832798458860
0.132967888947071
-0.00471839420330869
0.0687637732647276
-0.118564245306972
0.214553829976106
0.0534933608665058
0.0142278991813866
-0.00665264121740561
-0.0219784299148421
-0.186046714619444
0.0943826343127953
0.0556876304104580
-0.0784029238861660
0.0792745179197296
0.0571308422223183];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([-0.2 0.2])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('Alert Score x FC (Parahippocampus x Precuneus L) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))
    
%% Parahipocampus x Cingulum Mid L 2nd peak in the cluster
y = [0.139838534104782
-0.138309467939598
0.0289548452186523
-0.201749448169814
0.108846540144504
-0.185767572787586
0.0981170200150424
0.298658658778498
-0.195073015953009
0.192559898949715
-0.308078646797166
-0.332106233143035
-0.0777164079983662
0.341576871215932
-0.000283984934472917
0.0360377806418316
-0.226859873321160
0.202266596431276
0.0438624713299870
0.00325196479469295
0.0761290109193978
-0.0563851850663045
0.0663792645381791
-0.0497990820329883
0.135649461061006
-0.0464093748665772
-0.0189745828435995
0.105670861432109
-0.0669590446766682
0.0252223410469336
-0.330303970591972
0.0919250977532763
0.0373256155023111
0.0967689362882968
0.162838442218986
0.0644691588799400
0.0610501915357061
-0.120466507965209
0.0220811959630308
0.0446693873279749
-0.210545640894798
-0.243591278610659
-0.0642914580093559
0.202547177508653
-0.215673686088804
-0.0814073107341253
0.0833383388611626
0.205878698267779
0.190830300007993
0.00400711268759467];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([-0.25 0.25])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('Alert Score x FC (Parahippocampus x Cingulum Mid L) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))
    
%% Parahippocampus x BA40 L (Angular)
y = [0.116695844223369
-0.256867620263040
-0.120306280855997
-0.117539461324892
0.130034060726138
0.119498509996514
0.127601288002083
0.347970744108532
-0.105517758922149
-0.0908808837491594
-0.275561451992444
-0.255819955349218
0.0694065653984286
0.217732353293091
-0.117264203138737
0.172050659480249
-0.201599748100918
0.181432318080173
0.0800243349452792
0.0444594933228760
-0.213310940453515
0.0758253509401121
0.0414751750032302
-0.181238820681125
0.211700427311115
-0.0181380432432212
0.0222620422604303
0.131184421759616
-0.214408929810136
0.103974263366143
0.0817326931621649
-0.00456592357930222
-0.0754478350817931
-0.194473572096057
-0.104677052720180
-0.0846580956937728
-0.0606440333283455
0.159635970965439
0.313785141248156
0.218559818580891
0.00991566015439854
0.114377836904329
0.0481931580883128
-0.256511787811713
-0.185204907969330
-0.0979106059587332
0.0333839772665653
-0.156642699089800
0.141304752186077
0.0749737504398404];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([-0.25 0.25])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('Alert Score x FC (Parahippocampus x BA40 (Angular) L) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))
    
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Alert Score x Group Interaction Effects
x = covars.val{5}; % ANT Alerting RT log

%% Parahippocampus x SMA R - TREND
y = [0.0463197313925760
-0.0328110020304602
-0.153935656150073
-0.0212118421291712
0.0306203944114861
-0.0436404107588593
0.0557633579299331
-0.0722081605789193
0.00213688762001603
-0.175002308564074
-0.144220380625837
-0.229984679782072
-0.123828694854747
0.0643866749701405
-0.0240374130178987
0.304970407864873
0.0815395941673776
0.165099394294986
-0.150543066415758
0.0340047029841621
-0.0232081149023105
-0.0588862571445752
0.0788556437976622
0.186989089670899
0.202832107850643
0.0868418643742526
-0.0518693692811600
-0.0590807949003608
-0.0132104724326820
0.128934377898535
-0.150839097627199
-0.0430959663407133
0.0454459187885656
0.155633490743676
0.194459558267472
0.0148216788185784
-0.0731536343741180
-0.112568593418773
-0.275531551129551
0.0725083955645669
-0.131502936298105
-0.184596427526312
0.133831427865113
0.0236311728884141
-0.0427109388812018
0.0830534402659743
0.0536492878880687
0.0545312880917626
0.00493338036157108
0.0858845003936121];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([-0.25 0.25])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('Alert Score x Group x FC (Parahippocampus x SMA R - TREND) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%% Parahippocampus x Frontal Sup R - TREND 2nd peak in the cluster
y = [-0.0355030941063199
0.0782042906473901
0.125094847922174
-0.138583576996511
0.0499793690062860
-0.111300900340658
-0.0672409545465167
0.188271608520753
-0.159448205698653
-0.134109453062173
-0.0468381645757754
-0.250882208486196
-0.138747432307429
0.133997132924275
-0.0787882236349962
0.181515490914042
0.0591333382213266
0.264426931328718
-0.105787483864557
0.00873514865521913
0.127272069060065
-0.158891050021281
-0.0991850375443575
-0.00134424132035976
0.310019799305532
0.0767790737065957
-0.0441894940975748
0.313878768447598
0.137330604825410
0.368417857071953
-0.233100049248116
-0.0496086277555434
-0.0803514172175585
0.134069665105761
0.226707855923027
-0.0883436581119920
0.0980561466413707
0.141503353518905
-0.261115944092438
0.0467688763697634
0.183525881605987
-0.0855342371279886
0.0627241737436448
-0.345992720726737
-0.132479245539181
-0.0799418151681702
-0.00275291547678022
0.00128885427471728
-0.244327402289777
-0.143313584382892]
[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([-0.25 0.25])
ylim([-0.4 0.4])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('Alert Score x Group x FC (Parahippocampus x Frontal Sup R - TREND) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% RT Standard Deviation Effects
x = covars.val{6}; % ANT RT Standard deviation

%% dPC x Temporal Mid R
y = [-0.137231978547916
0.0641115051323159
-0.395251515807048
0.274474804463935
0.189651548888930
-0.0671317742377331
0.236346009826217
0.452052549390158
-0.0484519527659123
0.237829546792902
-0.0718915060112243
-0.00193901837715764
-0.170837878294005
-0.107174049781310
0.236832019811416
-0.319310682337185
0.0793164653790244
0.463418654631446
-0.339912984850834
0.0549446281944012
-0.378595076672088
-0.241598249168541
0.0163493530419119
-0.215455285923245
0.189454867221549
0.127607668698868
0.0538018743438400
-0.186849362991731
0.0679218270255208
-0.298077970839175
-0.104163622822056
0.0453655390062040
0.0610689231348298
0.105059453208304
0.253851549763909
-0.139517841165896
0.0143952171876483
0.221743008470559
-0.523656907460844
0.379963136495654
0.320055702779308
-0.0794818456127888
0.184468375604584
0.221071438365302
0.232495985159550
-0.674177212553263
-0.196185871455264
-0.0512781837220737
-0.127024955037202
0.0915440744161847];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([0 0.4])
ylim([-0.7 0.7])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('RT STD x FC (dPC x Temporal Mid R) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%% Parahippocampus x BA40 R (Parietal Inf)
y = [-0.00275632462213890
-0.0256407024833809
-0.146296221675430
-0.110444152118777
0.0808086606819726
-0.108129701016929
-0.217975518385620
0.235597225507663
0.0492398934742812
0.0193213878010834
-0.154402884855653
0.152268960499343
0.304007504876037
-0.130546730185665
0.00363686807631290
0.00501024578289146
0.0112582750869362
0.283679175987150
0.0510799762775799
-0.129111789046712
0.00709329968097608
-0.0438845962060079
-0.0499975740752763
-0.159162793557702
0.0753475144970635
-0.0789012517757121
0.248689697661831
-0.259645159736638
0.0697142421705346
0.419114033092186
-0.0737539707322288
0.0447149940958083
-0.0263643192602348
-0.186166280372902
-0.0961072189888773
0.135930722054420
-0.0304768872343611
-0.0947071810806416
0.0836521919398681
-0.0189190544273991
-0.266775689314200
0.00661588085544858
-0.0278693101837551
0.0529554058499300
0.0610136135521943
0.322777777854404
0.0868524245515557
-0.168695064254681
-0.203763190953515
0.000113594636962797];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([0 0.4])
ylim([-0.7 0.7])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('RT STD x FC (PH x BA40 R (Parietal Inf)) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% RT Standard Deviation x Group Interaction
x = covars.val{6}; % ANT RT standard deviation

%% dPC x Temporal Mid R
y = [-0.141932925194183
0.0709113009921300
-0.420214027839642
0.228142775453457
0.190535833324883
-0.0897643297962174
0.267183736741153
0.479331325786614
0.0104963620509647
0.253441777144362
-0.0683211636476204
0.0177774357301244
-0.189454933194772
-0.171508386733123
0.290539444012635
-0.299485015985365
0.0531056643339783
0.515705341243030
-0.344404946645682
0.0227447976038861
-0.394645909592997
-0.269384946878795
0.0198257518538318
-0.246303270719596
0.215678309956947
0.0990117822178153
0.174796336643618
-0.188987651156468
0.0191194144020758
-0.208894602134157
-0.160152056255347
0.0347673202371435
0.0925146707279184
0.0589748205937227
0.212240350602636
-0.0827072379799308
-0.0109980288521328
0.163490914226084
-0.473581471286652
0.344679365034961
0.313827466398592
-0.0816060891668078
0.157835496752199
0.203678578550341
0.255424019167449
-0.567173905460213
-0.194462435936996
-0.0311531469231484
-0.186135067408158
0.0554911570054185];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([-0.2 0.2])
ylim([-0.45 0.45])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('RT STD x Group x FC (dPC x Temporal Mid R) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Age Effects
x = covars.val{1};

%% Audio R x BA10 L (Frontal Mid)
y = [0.156700788887960
-0.138878075370970
-0.0156248658398350
-0.0764517089125850
-0.0148968861618239
-0.182959536372601
-0.0704820689492766
0.110235525979630
0.0944626592068168
-0.165636368453343
-0.146473104393023
0.0893147827930881
0.103082374772904
-0.255424866865452
0.174607065391005
0.0742803252949753
0.0171611912858921
-0.0363004270428567
0.0537899883814571
-0.202588862963158
0.0847111311245497
0.251046246183089
0.00674255322411602
0.216772446122543
-0.127190307323096
-0.0282800574164370
0.403634709537918
-0.0391847775340957
0.163699961197376
-0.0909624854852663
0.106676846522958
-0.131960868075652
-0.0100232839956715
0.0841705098670842
-0.305426060744488
-0.0831803879077616
-0.194912400989778
-0.174422964597202
-0.0669124557610741
0.0106530039455057
0.0723704437577835
0.229545673996998
0.130776621238763
0.0950012795352100
-0.0836457217194227
-0.0257729909981031
0.130993203279084
-0.0967126927540208
-0.0939294231112441
-0.00219568178845084];

[rcor_control,pvalcor_control] = corr(x(1:25),y(1:25))

[rcor_tinnitus,pvalcor_tinnitus] = corr(x(26:50),y(26:50))

px = polyfit(x(1:25),y(1:25),1);
pxx = [min(x(1:25)) max(x(1:25))];
pxy = polyval(px, pxx);

py = polyfit(x(26:50),y(26:50),1);
pyx = [min(x(26:50)) max(x(26:50))];
pyy = polyval(py,pyx);


figure
scatter(x(1:25),y(1:25), 25, 'filled','MarkerEdgeColor',[0 .5 .5],...
              'MarkerFaceColor',[0 .7 .7],...
              'LineWidth',1.5)
hold on
plot(pxx,pxy, 'LineWidth', 2, 'Color',[0,0.7,0.9])

hold on
scatter(x(26:50),y(26:50), 50, 'filled','MarkerEdgeColor',[0 .1 .1],...
              'MarkerFaceColor',[1 .5 .5],...
              'LineWidth',1.5)
hold on
plot(pyx,pyy, 'LineWidth', 2, 'Color',[1,0.5,0])

xlim([20 60])
ylim([-0.5 0.5])
line(xlim,[0 0], 'Color','black', 'LineStyle','--')
line([0 0],ylim, 'Color','black', 'LineStyle','--')

title(sprintf('Age x FC (rAC x BA10 L (Frontal Mid)) r-tin=%.2f r-con=%.2f', rcor_tinnitus, rcor_control))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Sex Effects
x = covars.val{2};

%% Audio R x Supramarginal Gyrus R 
y = [0.198021753638139
-0.172295409017920
0.0681261300475155
-0.454700969275451
0.0452785702718423
0.209447689961327
-0.135026804449191
-0.0421492566296632
0.174965454084796
-0.0846983000618903
-0.0807249124683649
0.0776040692133937
0.195246319723248
-0.166489372811057
0.218431578943137
-0.0687537946610522
0.285849421852501
0.0434993772783537
-0.0851255079762060
-0.161416684474053
-0.200247804789049
0.0452524454631230
-0.0156152050140883
0.182793094687056
-0.0772718835364481
0.111840740545135
-0.124594074848192
0.148291873521650
-0.163130861315396
0.159589336295197
-0.273136872443387
0.0185787280739516
0.00730771643610514
-0.115209639425701
-0.603828471095016
0.0885927167493824
0.0889022153762075
0.266977713462896
-0.101157475624243
0.0508522009104220
0.234505971748105
0.00865760857460421
0.0725888030955566
0.151071395151228
-0.137778218601441
-0.0805138372550564
0.183592889924211
0.0743176435125666
-0.0753608263286574
0.00904272355987276];

figure
boxplot([y(vertcat(sex.indexes{1:25,1})),y(vertcat(sex.indexes{1:25,2}))], 'Notch','on', 'Labels', {'F', 'M'}, 'Whisker',1);
title('Sex x FC (AC R x Supramarginal Gyrus R & Postcentral Cx)')

